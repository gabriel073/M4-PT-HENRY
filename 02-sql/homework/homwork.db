1-Birthyear
    Buscá todas las películas filmadas en el año que naciste.


SELECT * FROM movies
WHERE year = 1981
LIMIT 15;


2-1982
    Cuantas películas hay en la DB que sean del año 1982?

SELECT COUNT(*) as total
FROM movies
WHERE year = 1982


3- Stacktors
    Buscá actores que tengan el substring stack en su apellido.

SELECT *
FROM actors
WHERE last_name LIKE '%stack%';

4-Fame Name Game
    Buscá los 10 nombres y apellidos más populares entre los actores. Cuantos actores tienen cada uno de esos nombres y apellidos?

    Esta consulta puede involucrar múltiples queries.

 SELECT first_name, last_name, COUNT(*) as cantidad
 FROM actors
 GROUP BY LOWER(first_name), LOWER(last_name)
 ORDER BY cantidad DESC
 LIMIT 10;


5- Prolific
    Listá el top 100 de actores más activos junto con el número de roles que haya realizado.

--- actors <--------->  roles

SELECT a.first_name, a.last_name, COUNT(*) as cantidad
FROM actors as a
JOIN roles as r
ON a.id = r.actor_id
GROUP BY a.id
ORDER BY cantidad DESC
LIMIT 100;

6-Bottom of the Barrel
      Cuantas películas tiene IMDB por género? Ordená la lista por el género menos popular.

SELECT genre, COUNT(*) as cantidad
FROM movies_genres
GROUP BY GENRE
ORDER BY cantidad;


7-Braveheart
    Listá el nombre y apellido de todos los actores que trabajaron en la película "Braveheart" de 1995, ordená la lista alfabéticamente por apellido.

    -- actors <------ roles ---------> movies

SELECT a.first_name, a.last_name, m.name, m.year
FROM actors as a
JOIN roles as r ON a.id = r.actor_id
JOIN movies as m ON m.id = r.movie_id
WHERE m.name = 'Braveheart' AND m.year = 1995
ORDER BY LOWER(a.last_name);


8-Leap Noir
    Listá todos los directores que dirigieron una película de género 'Film-Noir' en un año bisiesto (para reducir la complejidad, asumí que cualquier año divisible por cuatro es bisiesto). Tu consulta debería devolver el nombre del director, el nombre de la peli y el año. Todo ordenado por el nombre de la película.

-- directors <-----------> movies_directors -------> movies <---- movie_id -----> movies_genres
SELECT d.first_name, d.last_name, m.name, m.year
FROM directors as d
JOIN movies_directors as mDir ON d.id = mDir.director_id
JOIN movies as m ON m.id = mDir.movie_id
JOIN movies_genres as mGenre ON mGenre.movie_id = m.id
WHERE mGenre.genre = 'Film-Noir' AND m.year % 4 = 0
ORDER BY m.name;



 9-° Bacon
     Listá todos los actores que hayan trabajado con Kevin Bacon en películas de Drama (incluí el título de la peli). Excluí al señor Bacon de los resultados.

    Índices
    En el shell de sqlite, si usas el comando .schema en la tabla actors vas a ver que en la creación de la tabla se incluyeron:

    CREATE INDEX "actors_idx_first_name" ON "actors" ("first_name");
    CREATE INDEX "actors_idx_last_name" ON "actors" ("last_name");

---SUB QUERY
SELECT m.id
FROM movies as m
JOIN roles as r ON m.id = r.movie_id
JOIN actors as a ON a.id = r.actor_id
WHERE a.first_name = 'Kevin' AND a.last_name = 'Bacon';

SELECT DISTINCT a.first_name, a.last_name
FROM actors as a 
JOIN roles as r ON a.id = r.actor_id
JOIN movies as m ON m.id = r.movie_id
JOIN movies_genres as mG ON m.id = mG.movie_id
WHERE mG.genre = 'Drama' AND m.id IN (
    SELECT m.id
FROM movies as m
JOIN roles as r ON m.id = r.movie_id
JOIN actors as a ON a.id = r.actor_id
WHERE a.first_name = 'Kevin' AND a.last_name = 'Bacon'
) AND (a.first_name || ' ' || a.last_name != 'Kevin Bacon')
ORDER BY a.last_name DESC;



10-Immortal Actors
   Qué actores actuaron en una película antes de 1900 y también en una película después del 2000?


SELECT *
FROM actors as a
WHERE a.id IN (
    SELECT r.actor_id
    FROM roles as r
    JOIN movies as m ON m.id = r.movie_id
    WHERE m.year < 1900
    ) AND a.id IN (
        SELECT r.actor_id
        FROM roles as r
        JOIN movies as m ON m.id = r.movie_id
        WHERE m.year > 2000
        )
        LIMIT 40;




11-Busy Filming
     Buscá actores que actuaron en cinco o más roles en la misma película después del año 1990. Noten que los ROLES pueden tener duplicados ocasionales, sobre los cuales no estamos interesados: queremos actores que hayan tenido cinco o más roles DISTINTOS (DISTINCT cough cough) en la misma película. Escribí un query que retorne los nombres del actor, el título de la película y el número de roles (siempre debería ser > 5).

SELECT a.first_name, a.last_name, m.name, COUNT(DISTINCT role) as total_roles
FROM actors as a
JOIN roles as r ON a.id = r.actor_id
JOIN movies as m ON m.id = r.movie_id
WHERE m.year > 1990
GROUP BY a.id, m.id
HAVING total_roles > 5;



 12-Para cada año, contá el número de películas en ese años que sólo tuvieron actrices femeninas.

    TIP: Podrías necesitar sub-queries. Lee más sobre sub-queries acá.

    SELECT m.year, COUNT(*) as cantidad
    FROM movies as m 
    WHERE m.id NOT IN(
        SELECT r.movie_id
        FROM roles as r 
        JOIN actors as a ON r.actor_id = a.id
        WHERE a.gender = 'M'
    )
    GROUP BY m.year
    ORDER BY m.year DESC; 